# 스프링과 객체지향 설계

## Chapter 6: 안티패턴
- **안티패턴의 종류**:
    1. 스마트 UI
    2. 양방향 레이어드
    3. 레이어를 건너뛰어 참조

- **팁**:
    1. 비즈니스 로직은 서비스가 아닌 도메인 모델(Post, Board, ...)이 수행해야 함 (책임).
        - 서비스는 도메인 모델에게 일을 시키는 역할.
    2. Request(DTO)에 id값을 받으면 위조 요청에 취약해짐.
        - UserPrincipal로 받고 Command에 담아서 전달.
        - Request는 `@RequestBody`를 처리하는 역할.
        - Command 사용 시 DTO가 많아지는 문제는 정답이 없음.
    3. **코드 중복**과 **코드 유사성** (181p)

## Chapter 7: 서비스
- 서비스가 단순히 비즈니스 로직을 모두 처리하는 곳이라는 개념은 부정확.
    - **애플리케이션 서비스**:
        - 도메인을 저장소에서 불러오고 도메인 또는 도메인 서비스에게 일을 시킴.
        - 도메인을 저장소에 저장함.
    - **도메인 서비스**:
        - 비즈니스 연산 로직을 처리.
        - 도메인 협력을 중재하고 기술할 수 없는 연산 로직을 처리.
    - **도메인**:
        - 비즈니스 로직을 처리하고 다른 도메인과 협력함.

- **팁**:
    1. 현재 작성 중인 서비스 코드가 도메인 객체에 들어갈 수 없는지 고민해보기.
    2. 서비스는 최대한 간결하게, 도메인을 풍부하게 만들기.
    3. 새로운 도메인(예: Cachier)을 만들어 해결할 수 있는지 고민해보기.

- 서비스는 생성자 주입으로 초기화해야 함 (불변성을 위해).

## Chapter 8: 레이어드 아키텍처
- **아키텍처는 제약**:
    - 레이어 구조를 사용 (Presentation Layer, Business Layer, Infrastructure Layer) (230p).
    - 레이어 간 의존 방향은 단방향.
    - Domain Layer는 어떤 의존성도 가지지 않음 (254p).

- **프로그램 개발 순서**:
    1. 엔터티부터 개발:
        - 데이터베이스에 종속적이 될 수 있음.
    2. 컨트롤러부터 개발:
        - API 서버 방식에 종속될 수 있음.
    3. **도메인부터 개발 (가장 좋은 방법)**:
        - 순수 자바로 도메인 레이어부터 개발.
        - 엔터티는 도메인과 별개로 Infrastructure Layer에 위치 (236p).
        - 예시: `ProductEntity`는 `infrastructure` 패키지에, `Product`는 `domain` 패키지에 위치.

- **팁**:
    1. Application Layer의 Service와 Infrastructure의 Repository는 **의존성 역전**을 활용 (246p).
        - 비즈니스 로직이 외부 기술에 의존하지 않도록 설계 가능.
    2. 헥사고날 아키텍처와 유사 (248p).
    3. 개발 전에 아키텍처 설계를 해보기 (각 레이어의 의존 방향 등).

## Chapter 9: 모듈
- **모듈이란**:
    - 독립성과 은닉성을 가지며, 모듈이 다른 모듈에 의존하거나 공개되는 관계를 관리.
    - 패키지 단위로 모듈을 나누며, 도메인 기반 구조 권장 (282p).

## Chapter 10: 도메인
- 기술 중심이 아닌, **도메인 중심**으로 설계하고 개발.

## Chapter 11: 알아두면 유용한 스프링 활용법
- 책 참고 (여러 빈을 `List`로 주입받는 방법 등).
